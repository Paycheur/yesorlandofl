!function($){var DateRangePicker=function(element,options,cb){var localeObject,hasOptions="object"==typeof options;this.startDate=Date.today(),this.endDate=Date.today(),this.minDate=!1,this.maxDate=!1,this.changed=!1,this.ranges={},this.opens="right",this.cb=function(){},this.format="MM/dd/yyyy",this.separator=" - ",this.showWeekNumbers=!1,this.buttonClasses=["btn-primary"],this.locale={applyLabel:"Apply",fromLabel:"From",toLabel:"To",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:Date.CultureInfo.shortestDayNames,monthNames:Date.CultureInfo.monthNames,firstDay:0},localeObject=this.locale,this.leftCalendar={month:Date.today().set({day:1,month:this.startDate.getMonth(),year:this.startDate.getFullYear()}),calendar:Array()},this.rightCalendar={month:Date.today().set({day:1,month:this.endDate.getMonth(),year:this.endDate.getFullYear()}),calendar:Array()},this.parentEl="body",this.element=$(element),this.element.hasClass("pull-right")&&(this.opens="left"),this.element.is("input")?this.element.on({click:$.proxy(this.show,this),focus:$.proxy(this.show,this)}):this.element.on("click",$.proxy(this.show,this)),hasOptions&&"object"==typeof options.locale&&$.each(localeObject,function(property,value){localeObject[property]=options.locale[property]||value});var DRPTemplate='<div class="daterangepicker dropdown-menu"><div class="calendar left"></div><div class="calendar right"></div><div class="ranges"><div class="range_inputs"><div><label for="daterangepicker_start">'+this.locale.fromLabel+"</label>"+'<input class="input-mini form-control" type="text" name="daterangepicker_start" value="" disabled="disabled" />'+"</div>"+"<div>"+'<label for="daterangepicker_end">'+this.locale.toLabel+"</label>"+'<input class="input-mini form-control" type="text" name="daterangepicker_end" value="" disabled="disabled" />'+"</div>"+'<button class="btn btn-small" disabled="disabled">'+this.locale.applyLabel+"</button>"+"</div>"+"</div>"+"</div>";if(this.parentEl=hasOptions&&options.parentEl&&$(options.parentEl)||$(this.parentEl),this.container=$(DRPTemplate).appendTo(this.parentEl),hasOptions){if("string"==typeof options.format&&(this.format=options.format),"string"==typeof options.separator&&(this.separator=options.separator),"string"==typeof options.startDate&&(this.startDate=Date.parse(options.startDate,this.format)),"string"==typeof options.endDate&&(this.endDate=Date.parse(options.endDate,this.format)),"string"==typeof options.minDate&&(this.minDate=Date.parse(options.minDate,this.format)),"string"==typeof options.maxDate&&(this.maxDate=Date.parse(options.maxDate,this.format)),"object"==typeof options.startDate&&(this.startDate=options.startDate),"object"==typeof options.endDate&&(this.endDate=options.endDate),"object"==typeof options.minDate&&(this.minDate=options.minDate),"object"==typeof options.maxDate&&(this.maxDate=options.maxDate),"object"==typeof options.ranges){for(var range in options.ranges){var start=options.ranges[range][0],end=options.ranges[range][1];"string"==typeof start&&(start=Date.parse(start)),"string"==typeof end&&(end=Date.parse(end)),this.minDate&&start<this.minDate&&(start=this.minDate),this.maxDate&&end>this.maxDate&&(end=this.maxDate),this.minDate&&end<this.minDate||this.maxDate&&start>this.maxDate||(this.ranges[range]=[start,end])}var list="<ul>";for(var range in this.ranges)list+="<li>"+range+"</li>";list+="<li>"+this.locale.customRangeLabel+"</li>",list+="</ul>",this.container.find(".ranges").prepend(list)}if("object"==typeof options.locale&&"number"==typeof options.locale.firstDay){this.locale.firstDay=options.locale.firstDay;for(var iterator=options.locale.firstDay;iterator>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),iterator--}"string"==typeof options.opens&&(this.opens=options.opens),"boolean"==typeof options.showWeekNumbers&&(this.showWeekNumbers=options.showWeekNumbers),"string"==typeof options.buttonClasses&&(this.buttonClasses=[options.buttonClasses]),"object"==typeof options.buttonClasses&&(this.buttonClasses=options.buttonClasses)}var c=this.container;if($.each(this.buttonClasses,function(idx,val){c.find("button").addClass(val)}),"right"==this.opens){var left=this.container.find(".calendar.left"),right=this.container.find(".calendar.right");left.removeClass("left").addClass("right"),right.removeClass("right").addClass("left")}("undefined"==typeof options||"undefined"==typeof options.ranges)&&this.container.find(".calendar").show(),"function"==typeof cb&&(this.cb=cb),this.container.addClass("opens"+this.opens),this.container.on("mousedown",$.proxy(this.mousedown,this)),this.container.find(".calendar").on("click",".prev",$.proxy(this.clickPrev,this)),this.container.find(".calendar").on("click",".next",$.proxy(this.clickNext,this)),this.container.find(".ranges").on("click","button",$.proxy(this.clickApply,this)),this.container.find(".calendar").on("click","td.available",$.proxy(this.clickDate,this)),this.container.find(".calendar").on("mouseenter","td.available",$.proxy(this.enterDate,this)),this.container.find(".calendar").on("mouseleave","td.available",$.proxy(this.updateView,this)),this.container.find(".ranges").on("click","li",$.proxy(this.clickRange,this)),this.container.find(".ranges").on("mouseenter","li",$.proxy(this.enterRange,this)),this.container.find(".ranges").on("mouseleave","li",$.proxy(this.updateView,this)),this.element.on("keyup",$.proxy(this.updateFromControl,this)),this.updateView(),this.updateCalendars()};DateRangePicker.prototype={constructor:DateRangePicker,mousedown:function(e){e.stopPropagation(),e.preventDefault()},updateView:function(){this.leftCalendar.month.set({month:this.startDate.getMonth(),year:this.startDate.getFullYear()}),this.rightCalendar.month.set({month:this.endDate.getMonth(),year:this.endDate.getFullYear()}),this.container.find("input[name=daterangepicker_start]").val(this.startDate.toString(this.format)),this.container.find("input[name=daterangepicker_end]").val(this.endDate.toString(this.format)),this.startDate.equals(this.endDate)||this.startDate.isBefore(this.endDate)?this.container.find("button").removeAttr("disabled"):this.container.find("button").attr("disabled","disabled")},updateFromControl:function(){if(this.element.is("input")){var dateString=this.element.val().split(this.separator),start=Date.parseExact(dateString[0],this.format),end=Date.parseExact(dateString[1],this.format);null!=start&&null!=end&&(end.isBefore(start)||(this.startDate=start,this.endDate=end,this.updateView(),this.cb(this.startDate,this.endDate),this.updateCalendars()))}},notify:function(){this.updateView(),this.element.is("input")&&this.element.val(this.startDate.toString(this.format)+this.separator+this.endDate.toString(this.format)),this.cb(this.startDate,this.endDate)},move:function(){var parentOffset={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()};"left"==this.opens?this.container.css({top:this.element.offset().top+this.element.outerHeight(),right:$(window).width()-this.element.offset().left-this.element.outerWidth()-parentOffset.left,left:"auto"}):this.container.css({top:this.element.offset().top+this.element.outerHeight(),left:this.element.offset().left-parentOffset.left,right:"auto"})},show:function(e){this.container.show(),this.move(),e&&(e.stopPropagation(),e.preventDefault()),this.changed=!1,$(document).on("mousedown",$.proxy(this.hide,this))},hide:function(){this.container.hide(),$(document).off("mousedown",this.hide),this.changed&&(this.changed=!1,this.notify())},enterRange:function(e){var label=e.target.innerHTML;if(label==this.locale.customRangeLabel)this.updateView();else{var dates=this.ranges[label];this.container.find("input[name=daterangepicker_start]").val(dates[0].toString(this.format)),this.container.find("input[name=daterangepicker_end]").val(dates[1].toString(this.format))}},clickRange:function(e){var label=e.target.innerHTML;if(label==this.locale.customRangeLabel)this.container.find(".calendar").show();else{var dates=this.ranges[label];this.startDate=dates[0],this.endDate=dates[1],this.leftCalendar.month.set({month:this.startDate.getMonth(),year:this.startDate.getFullYear()}),this.rightCalendar.month.set({month:this.endDate.getMonth(),year:this.endDate.getFullYear()}),this.updateCalendars(),this.changed=!0,this.container.find(".calendar").hide(),this.hide()}},clickPrev:function(e){var cal=$(e.target).parents(".calendar");cal.hasClass("left")?this.leftCalendar.month.add({months:-1}):this.rightCalendar.month.add({months:-1}),this.updateCalendars()},clickNext:function(e){var cal=$(e.target).parents(".calendar");cal.hasClass("left")?this.leftCalendar.month.add({months:1}):this.rightCalendar.month.add({months:1}),this.updateCalendars()},enterDate:function(e){var title=$(e.target).attr("title"),row=title.substr(1,1),col=title.substr(3,1),cal=$(e.target).parents(".calendar");cal.hasClass("left")?this.container.find("input[name=daterangepicker_start]").val(this.leftCalendar.calendar[row][col].toString(this.format)):this.container.find("input[name=daterangepicker_end]").val(this.rightCalendar.calendar[row][col].toString(this.format))},clickDate:function(e){var title=$(e.target).attr("title"),row=title.substr(1,1),col=title.substr(3,1),cal=$(e.target).parents(".calendar");cal.hasClass("left")?(startDate=this.leftCalendar.calendar[row][col],endDate=this.endDate):(startDate=this.startDate,endDate=this.rightCalendar.calendar[row][col]),cal.find("td").removeClass("active"),(startDate.equals(endDate)||startDate.isBefore(endDate))&&($(e.target).addClass("active"),startDate.equals(this.startDate)&&endDate.equals(this.endDate)||(this.changed=!0),this.startDate=startDate,this.endDate=endDate),this.leftCalendar.month.set({month:this.startDate.getMonth(),year:this.startDate.getFullYear()}),this.rightCalendar.month.set({month:this.endDate.getMonth(),year:this.endDate.getFullYear()}),this.updateCalendars()},clickApply:function(){this.hide()},updateCalendars:function(){this.leftCalendar.calendar=this.buildCalendar(this.leftCalendar.month.getMonth(),this.leftCalendar.month.getFullYear()),this.rightCalendar.calendar=this.buildCalendar(this.rightCalendar.month.getMonth(),this.rightCalendar.month.getFullYear()),this.container.find(".calendar.left").html(this.renderCalendar(this.leftCalendar.calendar,this.startDate,this.minDate,this.endDate)),this.container.find(".calendar.right").html(this.renderCalendar(this.rightCalendar.calendar,this.endDate,this.startDate,this.maxDate))},buildCalendar:function(month,year){var firstDay=Date.today().set({day:1,month:month,year:year}),lastMonth=firstDay.clone().add(-1).day().getMonth(),lastYear=firstDay.clone().add(-1).day().getFullYear();Date.getDaysInMonth(year,month);for(var daysInLastMonth=Date.getDaysInMonth(lastYear,lastMonth),dayOfWeek=firstDay.getDay(),calendar=Array(),i=0;6>i;i++)calendar[i]=Array();var startDay=daysInLastMonth-dayOfWeek+this.locale.firstDay+1;startDay>daysInLastMonth&&(startDay-=7),dayOfWeek==this.locale.firstDay&&(startDay=daysInLastMonth-6);for(var curDate=Date.today().set({day:startDay,month:lastMonth,year:lastYear}),i=0,col=0,row=0;42>i;i++,col++,curDate=curDate.clone().add(1).day())i>0&&0==col%7&&(col=0,row++),calendar[row][col]=curDate;return calendar},renderCalendar:function(calendar,selected,minDate,maxDate){var html='<table class="table-condensed">';html+="<thead>",html+="<tr>",this.showWeekNumbers&&(html+="<th></th>"),html+=!minDate||minDate<calendar[1][1]?'<th class="prev available"><i class="icon-arrow-left"></i></th>':"<th></th>",html+='<th colspan="5" style="width: auto">'+this.locale.monthNames[calendar[1][1].getMonth()]+calendar[1][1].toString(" yyyy")+"</th>",html+=!maxDate||maxDate>calendar[1][1]?'<th class="next available"><i class="icon-arrow-right"></i></th>':"<th></th>",html+="</tr>",html+="<tr>",this.showWeekNumbers&&(html+='<th class="week">'+this.locale.weekLabel+"</th>"),$.each(this.locale.daysOfWeek,function(index,dayOfWeek){html+="<th>"+dayOfWeek+"</th>"}),html+="</tr>",html+="</thead>",html+="<tbody>";for(var row=0;6>row;row++){html+="<tr>",this.showWeekNumbers&&(html+='<td class="week">'+calendar[row][0].getWeek()+"</td>");for(var col=0;7>col;col++){var cname="available ";cname+=calendar[row][col].getMonth()==calendar[1][1].getMonth()?"":"off",selected.setHours(0,0,0,0),minDate&&calendar[row][col]<minDate||maxDate&&calendar[row][col]>maxDate?cname="off disabled":calendar[row][col].equals(selected)&&(cname+="active");var title="r"+row+"c"+col;html+='<td class="'+cname+'" title="'+title+'">'+calendar[row][col].getDate()+"</td>"}html+="</tr>"}return html+="</tbody>",html+="</table>"}},$.fn.daterangepicker=function(options,cb){return this.each(function(){var el=$(this);el.data("daterangepicker")||el.data("daterangepicker",new DateRangePicker(el,options,cb))}),this}}(window.jQuery);